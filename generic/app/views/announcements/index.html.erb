<h2 class="current-page">Announcements  &gt; <%= link_to "Add New", resource(:announcements, :new) %></h2>


<div class="fullpage announcemt">
  <%= form_for(@announcement, :action => resource(:announcements), :method => 'get', :id => 'announcement') do %>

    <% if params[:access_name].nil? %>
        <span class="select-announce"><%= select :name => "access_name", :collection => classrooms, :label => "View :" %><%= submit "    Go    " %></span>
    <% else %>
        <span class="select-announce"><%= select :name => "access_name", :selected => params[:access_name], :collection => classrooms, :label => "View :" %><%= submit "    Go    " %></span>
    <% end %>
    
  <% end =%> 

  <% if params[:access_name].nil? %>
        <% for a in @announce %>
          
          <div class="data-block long-block">
            <% if a.created_at.nil? %>
	       <div class="ddmmm-x">
	       </div>
	    <% else %>
              <div class="ddmmm">
	          <span class="date"><%= a.created_at.strftime("%d") %></span>
	          <span class="month"><%= a.created_at.strftime("%b") %></span>
	       </div>
	    <% end %>
               <h3><%= link_to "#{a.title}", url(:announcement, a.id) %></h3>
               <span class="subText">Announcement for: <%= a.access_name %></span><br/>
               <span  class="subText">Created by <%= a.person.name %>, expires on <%= a.expiration.strftime("%d %b %Y") %></span>
               <p><%= snippet(a.content,50) %></p>
               <% if ( (a.approved) && (a.approve_announcement)) %>
                       <div class="approval-status">
                          <%= @message1 %>
                         </div>
                       <%= link_to "Edit", resource(a, :edit), :class=>"edit-btn" %>
                       <%= link_to "Delete", resource(a, :delete), :class=>"delete-btn"  %>
               <% elsif ((a.approve_announcement == true) && (a.approved == false )) %>
                       <div class="approval-status">
                          <%= @message2 %>
                         </div>
                       <%= link_to "Edit", resource(a, :edit), :class=>"edit-btn" %>
                       <%= link_to "Delete", resource(a, :delete), :class=>"delete-btn"  %>
               <% elsif ((a.approve_announcement == false) && (a.approved == false )) %>
                       <div class="approval-status">
                          <%= @message3 %>
                         </div>
                       <%= link_to "Edit", resource(a, :edit), :class=>"edit-btn" %>
                       <%= link_to "Delete", resource(a, :delete), :class=>"delete-btn"  %>
               <% end %>   <p class="separator">&nbsp;</p>
            
          </div>
      <% end %>	  
  <% elsif params[:access_name] == "All Announcements" %>  
          <% for a in @all_announcements %>

          <div class="data-block long-block">
            <% if a.created_at.nil? %>
	       <div class="ddmmm-x">
	       </div>
	    <% else %>
              <div class="ddmmm">
	          <span class="date"><%= a.created_at.strftime("%d") %></span>
	          <span class="month"><%= a.created_at.strftime("%b") %></span>
	       </div>
	    <% end %>
               <h3><%= link_to "#{a.title}", url(:announcement, a.id) %></h3>
               <span class="subText">Announcement for: <%= a.access_name %></span><br/>
               <span class="subText">Created by <%= a.person.name %>, expires on <%= a.expiration.strftime("%d %b %Y") %></span>
              <p><%= snippet(a.content,50) %></p>
               <% if ( (a.approved) && (a.approve_announcement)) %>
                       <div class="approval-status">
                        <%= @message1 %>
                       </div>
                       <%= link_to "Edit", resource(a, :edit), :class=>"edit-btn" %>
                       <%= link_to "Delete", resource(a, :delete), :class=>"delete-btn"  %>
               <% elsif ((a.approve_announcement == true) && (a.approved == false )) %>
                       <div class="approval-status">
                         <%= @message2 %>
                        </div>
                       <%= link_to "Edit", resource(a, :edit), :class=>"edit-btn" %>
                       <%= link_to "Delete", resource(a, :delete), :class=>"delete-btn"  %>
               <% elsif ((a.approve_announcement == false) && (a.approved == false )) %>
                       <div class="approval-status">
                         <%= @message3 %>
                        </div>
                       <%= link_to "Edit", resource(a, :edit), :class=>"edit-btn" %>
                       <%= link_to "Delete", resource(a, :delete), :class=>"delete-btn"  %>
               <% end %>   
              <p class="separator">&nbsp;</p>
          </div>
      <% end %>	  
  
  <% else %>    
         <% for announcement in @announcements %>

           <div class="data-block long-block">
             <% if announcement.created_at.nil? %>
                   <div class="ddmmm-x">
	                 </div>
              <% else %>
                   <div class="ddmmm">
                      <span class="date"><%= announcement.created_at.strftime("%d") %></span>
                      <span class="month"><%= announcement.created_at.strftime("%b") %></span>
	                 </div>
              <% end %>
              <h3><%= link_to "#{announcement.title}", url(:announcement, announcement.id) %></h3>
              <span class="subText">Announcement for: <%= announcement.access_name %></span><br/>
              <span class="subText">Created by <%= announcement.person.name %>, expires on <%= announcement.expiration.strftime("%d %b %Y") %></span>
              <p class="separator"><%= snippet(announcement.content,50) %></p>
              <% if ( (announcement.approved) && (announcement.approve_announcement)) %>
                       <div class="approval-status">
                          <%= @message1 %>
                         </div>
                       <%= link_to "Edit", resource(announcement, :edit), :class=>"edit-btn" %>
                       <%= link_to "Delete", resource(announcement, :delete), :class=>"delete-btn"  %>
                <% elsif ((announcement.approve_announcement == true) && (announcement.approved == false )) %>
                      <div class="approval-status">
                         <%= @message2 %>
                        </div>
                      <%= link_to "Edit", resource(announcement, :edit), :class=>"edit-btn" %>
                      <%= link_to "Delete", resource(announcement, :delete), :class=>"delete-btn"  %>
                <% elsif ((announcement.approve_announcement == false) && (announcement.approved == false )) %>
                       <div class="approval-status">
                          <%= @message3 %>
                         </div>
                       <%= link_to "Edit", resource(announcement, :edit), :class=>"edit-btn" %>
                       <%= link_to "Delete", resource(announcement, :delete), :class=>"delete-btn"  %>
                <% end %> 
               <p class="separator">&nbsp;</p>
           </div>
         <% end %>
  <% end %>
</div>

