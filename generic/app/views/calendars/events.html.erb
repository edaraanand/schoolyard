<div class="short-block">
    <% if params[:class_name].nil? %>
         <h2 class="current-page"> All Events </h2>
    <% elsif params[:class_name] == "All Events" %>
          <h2 class="current-page"> All Events </h2>
     <% else %> 
          <h2 class="current-page"> Events for <%= params[:class_name] %> </h2>
     <% end %>
     
  <%= form_for(@calendar, :action => url(:events), :method => 'get') do %>
  
  <% if params[:class_name].nil? %>
  <span class="select-announce"><%= select :name => "class_name", :collection => @classrooms, :label => "View :" %><%= submit "    Go    " %></span>
  <% else %>
      <span class="select-announce"><%= select :name => "class_name", :selected => params[:class_name], :collection => @classrooms, :label => "View :" %><%= submit "    Go    " %></span>
  <% end %>
<% end =%> 

<% if params[:class_name].nil? %>

       <% cdate=""
      for calendar in @cals %>
         <div class="calendar-block" style="width:480px;">
         <% if(cdate!=calendar.start_date.strftime("%B %d %Y"))
               cdate=calendar.start_date.strftime("%B %d %Y") %>
              <h3><%= cdate %></h3>  
         <% end %> 
    
         <ul class="calendar-items">
                <li>
                      <span class="cal-time">
                          <% unless calendar.start_time.nil? %>
                        Starts at <%= calendar.start_time.strftime("%I:%M%p") %>
                               <% end %>&nbsp;
                          </span>
                          <span class="cal-title">
                            <%= calendar.title %>
                          </span>
                          <span class="cal-time">
                            <% unless calendar.end_time.nil? %>
                          Ends at <%= calendar.end_time.strftime("%I:%M%p") %>
                                <% end %>  &nbsp;
                          </span>
                           Location : <%= calendar.location %>
                         <% @attachment = Attachment.find(:first, :conditions => ["attachable_id = ? and attachable_type =?", calendar.id, "Calendar"]) %>
                                       <% unless @attachment.nil? %>
                                            <p><%= link_to "#{@attachment.filename}", url(:download, :id => @attachment.id) %></p>
                                       <% end %>
                      </li>
                            
         </ul>
    </div>
             <% #@calendars.delete_if{|c| c.start_date == cdate } %>
         
  <% end %>
  
<% elsif params[:class_name] == "All Events" %>

          <% cdate=""
          for calendar in @calendars %>
         <div class="calendar-block" style="width:480px;">
         <% if(cdate!=calendar.start_date.strftime("%B %d %Y"))
               cdate=calendar.start_date.strftime("%B %d %Y") %>
              <h3><%= cdate %></h3>  
         <% end %> 
    
         <ul class="calendar-items">
                <li>
                      <span class="cal-time">
                          <% unless calendar.start_time.nil? %>
                        Starts at <%= calendar.start_time.strftime("%I:%M%p") %>
                               <% end %>&nbsp;
                          </span>
                          <span class="cal-title">
                            <%= calendar.title %>
                          </span>
                          <span class="cal-time">
                            <% unless calendar.end_time.nil? %>
                          Ends at <%= calendar.end_time.strftime("%I:%M%p") %>
                                <% end %>  &nbsp;
                          </span>
                           Location : <%= calendar.location %>
                         <% @attachment = Attachment.find(:first, :conditions => ["attachable_id = ? and attachable_type =?", calendar.id, "Calendar"]) %>
                                       <% unless @attachment.nil? %>
                                            <p><%= link_to "#{@attachment.filename}", url(:download, :id => @attachment.id) %></p>
                                       <% end %>
                      </li>
                            
         </ul>
    </div>
             <% #@calendars.delete_if{|c| c.start_date == cdate } %>
         
  <% end %>
<% else %>

            <% cdate=""
      for calendar in @cls %>
         <div class="calendar-block" style="width:480px;">
         <% if(cdate!=calendar.start_date.strftime("%B %d %Y"))
               cdate=calendar.start_date.strftime("%B %d %Y") %>
              <h3><%= cdate %></h3>  
         <% end %> 
    
         <ul class="calendar-items">
                <li>
                      <span class="cal-time">
                          <% unless calendar.start_time.nil? %>
                        Starts at <%= calendar.start_time.strftime("%I:%M%p") %>
                               <% end %>&nbsp;
                          </span>
                          <span class="cal-title">
                            <%= calendar.title %>
                          </span>
                          <span class="cal-time">
                            <% unless calendar.end_time.nil? %>
                          Ends at <%= calendar.end_time.strftime("%I:%M%p") %>
                                <% end %>  &nbsp;
                          </span>
                           Location : <%= calendar.location %>
                         <% @attachment = Attachment.find(:first, :conditions => ["attachable_id = ? and attachable_type =?", calendar.id, "Calendar"]) %>
                                       <% unless @attachment.nil? %>
                                            <p><%= link_to "#{@attachment.filename}", url(:download, :id => @attachment.id) %></p>
                                       <% end %>
                      </li>
                            
         </ul>
    </div>
             <% #@calendars.delete_if{|c| c.start_date == cdate } %>
         
  <% end %>
  
<% end %> 
</div>
